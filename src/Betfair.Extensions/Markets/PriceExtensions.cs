namespace Betfair.Extensions.Markets;

internal static class PriceExtensions
{
    internal static readonly double[] ValidPrices =
    [
        1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.09, 1.1, 1.11,
        1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18, 1.19, 1.2, 1.21, 1.22,
        1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29, 1.3, 1.31, 1.32, 1.33,
        1.34, 1.35, 1.36, 1.37, 1.38, 1.39, 1.4, 1.41, 1.42, 1.43, 1.44,
        1.45, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51, 1.52, 1.53, 1.54, 1.55,
        1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62, 1.63, 1.64, 1.65, 1.66,
        1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73, 1.74, 1.75, 1.76, 1.77,
        1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84, 1.85, 1.86, 1.87, 1.88,
        1.89, 1.9, 1.91, 1.92, 1.93, 1.94, 1.95, 1.96, 1.97, 1.98, 1.99,
        2.0,

        2.02, 2.04, 2.06, 2.08, 2.1, 2.12, 2.14, 2.16, 2.18, 2.2, 2.22,
        2.24, 2.26, 2.28, 2.3, 2.32, 2.34, 2.36, 2.38, 2.4, 2.42, 2.44,
        2.46, 2.48, 2.5, 2.52, 2.54, 2.56, 2.58, 2.6, 2.62, 2.64, 2.66,
        2.68, 2.7, 2.72, 2.74, 2.76, 2.78, 2.8, 2.82, 2.84, 2.86, 2.88,
        2.9, 2.92, 2.94, 2.96, 2.98, 3.0,

        3.05, 3.1, 3.15, 3.2, 3.25, 3.3, 3.35, 3.4, 3.45, 3.5, 3.55, 3.6,
        3.65, 3.7, 3.75, 3.8, 3.85, 3.9, 3.95, 4.0,

        4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5.0, 5.1, 5.2, 5.3,
        5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6.0,

        6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0, 8.2, 8.4, 8.6,
        8.8, 9.0, 9.2, 9.4, 9.6, 9.8, 10.0,

        10.5, 11.0, 11.5, 12.0, 12.5, 13.0, 13.5, 14.0, 14.5, 15.0, 15.5,
        16.0, 16.5, 17.0, 17.5, 18.0, 18.5, 19.0, 19.5,

        20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0,

        32.0, 34.0, 36.0, 38.0, 40.0, 42.0, 44.0, 46.0, 48.0, 50.0,

        55.0, 60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0,

        110.0, 120.0, 130.0, 140.0, 150.0, 160.0, 170.0, 180.0, 190.0, 200.0,
        210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0,
        310.0, 320.0, 330.0, 340.0, 350.0, 360.0, 370.0, 380.0, 390.0, 400.0,
        410.0, 420.0, 430.0, 440.0, 450.0, 460.0, 470.0, 480.0, 490.0, 500.0,
        510.0, 520.0, 530.0, 540.0, 550.0, 560.0, 570.0, 580.0, 590.0, 600.0,
        610.0, 620.0, 630.0, 640.0, 650.0, 660.0, 670.0, 680.0, 690.0, 700.0,
        710.0, 720.0, 730.0, 740.0, 750.0, 760.0, 770.0, 780.0, 790.0, 800.0,
        810.0, 820.0, 830.0, 840.0, 850.0, 860.0, 870.0, 880.0, 890.0, 900.0,
        910.0, 920.0, 930.0, 940.0, 950.0, 960.0, 970.0, 980.0, 990.0, 1000.0
    ];

    private static readonly Dictionary<double, double> _lowestValidPrices
           = new ()
           {
                { 0.01, 1.8 },
                { 0.02, 1.4 },
                { 0.03, 1.27 },
                { 0.04, 1.2 },
                { 0.05, 1.16 },
                { 0.06, 1.14 },
                { 0.07, 1.12 },
                { 0.08, 1.1 },
                { 0.09, 1.09 },
                { 0.1, 1.08 }, { 0.11, 1.08 },
                { 0.12, 1.07 }, { 0.13, 1.07 },
                { 0.14, 1.06 }, { 0.15, 1.06 },
                { 0.16, 1.05 }, { 0.17, 1.05 }, { 0.18, 1.05 }, { 0.19, 1.05 },
                { 0.2, 1.04 }, { 0.21, 1.04 }, { 0.22, 1.04 }, { 0.23, 1.04 },
                { 0.24, 1.04 }, { 0.25, 1.04 }, { 0.26, 1.04 },
                { 0.27, 1.03 }, { 0.28, 1.03 }, { 0.29, 1.03 }, { 0.3, 1.03 },
                { 0.31, 1.03 }, { 0.32, 1.03 }, { 0.33, 1.03 }, { 0.34, 1.03 },
                { 0.35, 1.03 }, { 0.36, 1.03 }, { 0.37, 1.03 }, { 0.38, 1.03 },
                { 0.39, 1.03 },
                { 0.4, 1.02 }, { 0.41, 1.02 }, { 0.42, 1.02 }, { 0.43, 1.02 },
                { 0.44, 1.02 }, { 0.45, 1.02 }, { 0.46, 1.02 }, { 0.47, 1.02 },
                { 0.48, 1.02 }, { 0.49, 1.02 }, { 0.5, 1.02 }, { 0.51, 1.02 },
                { 0.52, 1.02 }, { 0.53, 1.02 }, { 0.54, 1.02 }, { 0.55, 1.02 },
                { 0.56, 1.02 }, { 0.57, 1.02 }, { 0.58, 1.02 }, { 0.59, 1.02 },
                { 0.6, 1.02 }, { 0.61, 1.02 }, { 0.62, 1.02 },
                { 0.63, 1.03 }, { 0.64, 1.03 }, { 0.65, 1.03 }, { 0.66, 1.03 },
                { 0.67, 1.03 }, { 0.68, 1.03 }, { 0.69, 1.03 }, { 0.7, 1.03 },
                { 0.71, 1.03 }, { 0.72, 1.03 }, { 0.73, 1.03 }, { 0.74, 1.03 },
                { 0.75, 1.03 }, { 0.76, 1.03 }, { 0.77, 1.03 }, { 0.78, 1.03 },
                { 0.79, 1.03 },
                { 1.26, 1.02 }, { 1.27, 1.02 }, { 1.28, 1.02 }, { 1.29, 1.02 },
                { 1.3, 1.02 }, { 1.31, 1.02 }, { 1.32, 1.02 }, { 1.33, 1.02 },
                { 1.34, 1.02 }, { 1.35, 1.02 }, { 1.36, 1.02 }, { 1.37, 1.02 },
                { 1.38, 1.02 }, { 1.39, 1.02 }, { 1.4, 1.02 }, { 1.41, 1.02 },
                { 1.42, 1.02 }, { 1.43, 1.02 }, { 1.44, 1.02 }, { 1.45, 1.02 },
                { 1.46, 1.02 }, { 1.47, 1.02 }, { 1.48, 1.02 }, { 1.49, 1.02 },
                { 1.5, 1.02 }, { 1.51, 1.02 }, { 1.52, 1.02 }, { 1.53, 1.02 },
                { 1.54, 1.02 }, { 1.55, 1.02 }, { 1.56, 1.02 }, { 1.57, 1.02 },
                { 1.58, 1.02 }, { 1.59, 1.02 },
           };

    private static readonly Dictionary<double, double> _lowestValidSize
        = new ()
        {
            { 1.01, 0.8 },
            { 1.02, 0.4 },
            { 1.03, 0.27 },
            { 1.04, 0.2 },
            { 1.05, 0.16 },
            { 1.06, 0.14 },
            { 1.07, 0.12 },
            { 1.08, 0.1 },
            { 1.09, 0.09 },
            { 1.1, 0.08 }, { 1.11, 0.08 },
            { 1.12, 0.07 }, { 1.13, 0.07 },
            { 1.14, 0.06 }, { 1.15, 0.06 },
            { 1.16, 0.05 }, { 1.17, 0.05 }, { 1.18, 0.05 }, { 1.19, 0.05 },
            { 1.2, 0.04 }, { 1.21, 0.04 }, { 1.22, 0.04 }, { 1.23, 0.04 },
            { 1.24, 0.04 }, { 1.25, 0.04 }, { 1.26, 0.04 },
            { 1.27, 0.03 }, { 1.28, 0.03 }, { 1.29, 0.03 }, { 1.3, 0.03 },
            { 1.31, 0.03 }, { 1.32, 0.03 }, { 1.33, 0.03 }, { 1.34, 0.03 },
            { 1.35, 0.03 }, { 1.36, 0.03 }, { 1.37, 0.03 }, { 1.38, 0.03 },
            { 1.39, 0.03 },
            { 1.4, 0.02 }, { 1.41, 0.02 }, { 1.42, 0.02 }, { 1.43, 0.02 },
            { 1.44, 0.02 }, { 1.45, 0.02 }, { 1.46, 0.02 }, { 1.47, 0.02 },
            { 1.48, 0.02 }, { 1.49, 0.02 }, { 1.5, 0.02 }, { 1.51, 0.02 },
            { 1.52, 0.02 }, { 1.53, 0.02 }, { 1.54, 0.02 }, { 1.55, 0.02 },
            { 1.56, 0.02 }, { 1.57, 0.02 }, { 1.58, 0.02 }, { 1.59, 0.02 },
            { 1.6, 0.02 }, { 1.61, 0.02 }, { 1.62, 0.02 },
            { 1.63, 0.03 }, { 1.64, 0.03 }, { 1.65, 0.03 }, { 1.66, 0.03 },
            { 1.67, 0.03 }, { 1.68, 0.03 }, { 1.69, 0.03 }, { 1.7, 0.03 },
            { 1.71, 0.03 }, { 1.72, 0.03 }, { 1.73, 0.03 }, { 1.74, 0.03 },
            { 1.75, 0.03 }, { 1.76, 0.03 }, { 1.77, 0.03 }, { 1.78, 0.03 },
            { 1.79, 0.03 },
        };

    internal static double LowestValidPrice(this double size) =>
        _lowestValidPrices.GetValueOrDefault(size, 1.01);

    internal static double LowestValidSize(this Price price) =>
        _lowestValidSize.GetValueOrDefault(price.DecimalOdds, 0.01);
}